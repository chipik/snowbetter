# üöÄ –ë—ã—Å—Ç—Ä–æ–µ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ –Ω–∞ snowbetter.ru

## üìã –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞
```bash
# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å Docker –∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
sudo apt update
sudo apt install -y docker.io docker-compose curl nginx certbot python3-certbot-nginx

# –ù–∞—Å—Ç—Ä–æ–∏—Ç—å Docker
sudo usermod -aG docker $USER
sudo systemctl enable docker
sudo systemctl start docker
newgrp docker
```

### 2. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞
```bash
# –ö–ª–æ–Ω–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
git clone <your-repo-url>
cd ushe_luche

# –°–æ–∑–¥–∞—Ç—å .env —Ñ–∞–π–ª
cp env.production .env

# –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–∞—Ä–æ–ª–∏ –≤ .env
nano .env
```

**–û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å –≤ .env:**
- `POSTGRES_PASSWORD` - —Å–ª–æ–∂–Ω—ã–π –ø–∞—Ä–æ–ª—å –¥–ª—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
- `SECRET_KEY` - 32+ —Å–∏–º–≤–æ–ª–∞ –¥–ª—è JWT —Ç–æ–∫–µ–Ω–æ–≤
- `REDIS_PASSWORD` - –ø–∞—Ä–æ–ª—å –¥–ª—è Redis (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

### 3. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ DNS
–£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –¥–æ–º–µ–Ω `snowbetter.ru` —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ IP —Å–µ—Ä–≤–µ—Ä–∞:
```bash
# A-–∑–∞–ø–∏—Å—å
snowbetter.ru.     IN  A   YOUR_SERVER_IP
www.snowbetter.ru. IN  A   YOUR_SERVER_IP
```

### 4. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ñ–∞–π—Ä–≤–æ–ª–∞
```bash
# Ubuntu/Debian
sudo ufw allow 22/tcp    # SSH
sudo ufw allow 80/tcp    # HTTP
sudo ufw allow 443/tcp   # HTTPS
sudo ufw enable
```

### 5. –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ
```bash
# –°–¥–µ–ª–∞—Ç—å —Å–∫—Ä–∏–ø—Ç—ã –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–º–∏
chmod +x scripts/*.sh

# –ó–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–æ–¥–∞–∫—à–µ–Ω
make prod

# –ò–ª–∏ –≤—Ä—É—á–Ω—É—é
./scripts/deploy.sh start
```

### 6. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ SSL
```bash
# –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ SSL
make ssl-setup

# –ò–ª–∏ –≤—Ä—É—á–Ω—É—é
export DOMAIN=snowbetter.ru
export CERTBOT_EMAIL=admin@snowbetter.ru
./scripts/initial-ssl-setup.sh
```

## üîß –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ

### –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã
```bash
make prod              # –ó–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–æ–¥–∞–∫—à–µ–Ω
make prod-stop         # –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø—Ä–æ–¥–∞–∫—à–µ–Ω
make prod-status       # –°—Ç–∞—Ç—É—Å —Å–µ—Ä–≤–∏—Å–æ–≤
make prod-logs         # –õ–æ–≥–∏
make ssl-renew         # –û–±–Ω–æ–≤–∏—Ç—å SSL
make backup            # –°–æ–∑–¥–∞—Ç—å –±—ç–∫–∞–ø
make update            # –û–±–Ω–æ–≤–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
```

### –ß–µ—Ä–µ–∑ —Å–∫—Ä–∏–ø—Ç—ã
```bash
./scripts/deploy.sh start      # –ó–∞–ø—É—Å—Ç–∏—Ç—å
./scripts/deploy.sh stop       # –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å
./scripts/deploy.sh status     # –°—Ç–∞—Ç—É—Å
./scripts/deploy.sh logs       # –õ–æ–≥–∏
./scripts/deploy.sh backup     # –ë—ç–∫–∞–ø
./scripts/deploy.sh update     # –û–±–Ω–æ–≤–∏—Ç—å
```

## üåê –î–æ—Å—Ç—É–ø –∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—é

–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è:
- **Frontend**: https://snowbetter.ru
- **API**: https://snowbetter.ru/api
- **Health Check**: https://snowbetter.ru/health

## üîí SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã

- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ**: –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ —á–µ—Ä–µ–∑ cron
- **Let's Encrypt**: –±–µ—Å–ø–ª–∞—Ç–Ω—ã–µ SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã
- **HSTS**: –≤–∫–ª—é—á–µ–Ω –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞
```bash
# –°—Ç–∞—Ç—É—Å —Å–µ—Ä–≤–∏—Å–æ–≤
make prod-status

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è
make health

# –õ–æ–≥–∏
make prod-logs
```

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –±—ç–∫–∞–ø—ã
```bash
# –°–æ–∑–¥–∞—Ç—å –±—ç–∫–∞–ø
make backup

# –ù–∞—Å—Ç—Ä–æ–∏—Ç—å cron –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö –±—ç–∫–∞–ø–æ–≤
crontab -e
# –î–æ–±–∞–≤–∏—Ç—å: 0 2 * * * cd /path/to/app && make backup
```

## üõ†Ô∏è –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ–ø–æ–ª–∞–¥–æ–∫

### –ü—Ä–æ–±–ª–µ–º—ã —Å SSL
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã
sudo certbot certificates

# –û–±–Ω–æ–≤–∏—Ç—å –≤—Ä—É—á–Ω—É—é
make ssl-renew
```

### –ü—Ä–æ–±–ª–µ–º—ã —Å —Å–µ—Ä–≤–∏—Å–∞–º–∏
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏
make prod-logs

# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å
make prod-stop && make prod
```

### –ü—Ä–æ–±–ª–µ–º—ã —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö
```bash
# –ë—ç–∫–∞–ø
make db-backup

# –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ
make db-restore file=backup_20231201_120000.sql
```

## üìà –ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ
```bash
# –£–≤–µ–ª–∏—á–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ backend –∏–Ω—Å—Ç–∞–Ω—Å–æ–≤
docker-compose -f docker-compose.prod.yml up -d --scale backend=3

# –£–≤–µ–ª–∏—á–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ frontend –∏–Ω—Å—Ç–∞–Ω—Å–æ–≤
docker-compose -f docker-compose.prod.yml up -d --scale frontend=2
```

## üéØ –ß–µ–∫-–ª–∏—Å—Ç

- [ ] –°–µ—Ä–≤–µ—Ä –ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω (Docker, nginx, certbot)
- [ ] –î–æ–º–µ–Ω snowbetter.ru –Ω–∞—Å—Ç—Ä–æ–µ–Ω
- [ ] –§–∞–π—Ä–≤–æ–ª –Ω–∞—Å—Ç—Ä–æ–µ–Ω (–ø–æ—Ä—Ç—ã 22, 80, 443)
- [ ] .env —Ñ–∞–π–ª —Å–æ–∑–¥–∞–Ω –∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω
- [ ] –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç–æ
- [ ] SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã –ø–æ–ª—É—á–µ–Ω—ã
- [ ] HTTPS —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] API –æ—Ç–≤–µ—á–∞–µ—Ç
- [ ] –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ SSL –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ
- [ ] –ë—ç–∫–∞–ø—ã –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ü—Ä–∏ –ø—Ä–æ–±–ª–µ–º–∞—Ö:
1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏: `make prod-logs`
2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å: `make prod-status`
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å SSL: `sudo certbot certificates`
4. –°–æ–∑–¥–∞—Ç—å –±—ç–∫–∞–ø: `make backup`

**–£—Å–ø–µ—à–Ω–æ–≥–æ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è –Ω–∞ snowbetter.ru! üöÄ**
